2025-06-20 19:11:43,101 - INFO - Undo Script Logging initialized. Output will be saved to 'logs_undo\undo_run_20250620_191143.log'
2025-06-20 19:11:43,102 - INFO - Initializing API clients for Confluence and Jira...
2025-06-20 19:11:43,103 - INFO - 
--- Starting Undo Automation Script ---
2025-06-20 19:11:43,103 - INFO - Searching for latest results file in 'output'...
2025-06-20 19:11:43,103 - INFO - Found latest results file: 'output\automation_results_20250620_190621.xlsx' (Timestamp: 2025-06-20 19:06:21)
2025-06-20 19:11:43,546 - INFO - 
--- Phase 1: Transitioning Jira Tasks to 'Backlog' ---
2025-06-20 19:11:43,559 - INFO -   Attempting to transition Jira task 'SFSEA-921' to 'Backlog' via direct request...
2025-06-20 19:11:44,588 - ERROR -     -> ERROR: Unexpected error during direct transition for 'SFSEA-921'. Details: AttributeError("'Jira' object has no attribute 'get_all_transitions'")
2025-06-20 19:11:44,588 - INFO -   Attempting to transition Jira task 'SFSEA-922' to 'Backlog' via direct request...
2025-06-20 19:11:44,892 - INFO -     -> Jira task 'SFSEA-922' is already in 'Backlog'. Skipping transition.
2025-06-20 19:11:44,892 - INFO -   Attempting to transition Jira task 'SFSEA-923' to 'Backlog' via direct request...
2025-06-20 19:11:45,201 - INFO -     -> Jira task 'SFSEA-923' is already in 'Backlog'. Skipping transition.
2025-06-20 19:11:45,201 - INFO -   Attempting to transition Jira task 'SFSEA-924' to 'Backlog' via direct request...
2025-06-20 19:11:45,508 - INFO -     -> Jira task 'SFSEA-924' is already in 'Backlog'. Skipping transition.
2025-06-20 19:11:45,508 - INFO -   Attempting to transition Jira task 'SFSEA-925' to 'Backlog' via direct request...
2025-06-20 19:11:45,819 - INFO -     -> Jira task 'SFSEA-925' is already in 'Backlog'. Skipping transition.
2025-06-20 19:11:45,819 - INFO -   Attempting to transition Jira task 'SFSEA-926' to 'Backlog' via direct request...
2025-06-20 19:11:46,123 - INFO -     -> Jira task 'SFSEA-926' is already in 'Backlog'. Skipping transition.
2025-06-20 19:11:46,123 - INFO -   Attempting to transition Jira task 'SFSEA-927' to 'Backlog' via direct request...
2025-06-20 19:11:46,430 - INFO -     -> Jira task 'SFSEA-927' is already in 'Backlog'. Skipping transition.
2025-06-20 19:11:46,430 - INFO -   Attempting to transition Jira task 'SFSEA-928' to 'Backlog' via direct request...
2025-06-20 19:11:46,735 - INFO -     -> Jira task 'SFSEA-928' is already in 'Backlog'. Skipping transition.
2025-06-20 19:11:46,735 - INFO -   Attempting to transition Jira task 'SFSEA-929' to 'Backlog' via direct request...
2025-06-20 19:11:47,018 - INFO -     -> Jira task 'SFSEA-929' is already in 'Backlog'. Skipping transition.
2025-06-20 19:11:47,018 - INFO -   Attempting to transition Jira task 'SFSEA-930' to 'Backlog' via direct request...
2025-06-20 19:11:47,353 - INFO -     -> Jira task 'SFSEA-930' is already in 'Backlog'. Skipping transition.
2025-06-20 19:11:47,353 - INFO -   Attempting to transition Jira task 'SFSEA-931' to 'Backlog' via direct request...
2025-06-20 19:11:47,657 - INFO -     -> Jira task 'SFSEA-931' is already in 'Backlog'. Skipping transition.
2025-06-20 19:11:47,657 - INFO -   Attempting to transition Jira task 'SFSEA-932' to 'Backlog' via direct request...
2025-06-20 19:11:47,967 - INFO -     -> Jira task 'SFSEA-932' is already in 'Backlog'. Skipping transition.
2025-06-20 19:11:47,967 - INFO -   Attempting to transition Jira task 'SFSEA-933' to 'Backlog' via direct request...
2025-06-20 19:11:48,270 - INFO -     -> Jira task 'SFSEA-933' is already in 'Backlog'. Skipping transition.
2025-06-20 19:11:48,270 - INFO -   Attempting to transition Jira task 'SFSEA-934' to 'Backlog' via direct request...
2025-06-20 19:11:48,584 - INFO -     -> Jira task 'SFSEA-934' is already in 'Backlog'. Skipping transition.
2025-06-20 19:11:48,588 - INFO -   Attempting to transition Jira task 'SFSEA-935' to 'Backlog' via direct request...
2025-06-20 19:11:48,886 - INFO -     -> Jira task 'SFSEA-935' is already in 'Backlog'. Skipping transition.
2025-06-20 19:11:48,894 - INFO -   Attempting to transition Jira task 'SFSEA-936' to 'Backlog' via direct request...
2025-06-20 19:11:49,195 - INFO -     -> Jira task 'SFSEA-936' is already in 'Backlog'. Skipping transition.
2025-06-20 19:11:49,195 - INFO -   Attempting to transition Jira task 'SFSEA-937' to 'Backlog' via direct request...
2025-06-20 19:11:49,473 - INFO -     -> Jira task 'SFSEA-937' is already in 'Backlog'. Skipping transition.
2025-06-20 19:11:49,473 - INFO -   Attempting to transition Jira task 'SFSEA-938' to 'Backlog' via direct request...
2025-06-20 19:11:49,751 - INFO -     -> Jira task 'SFSEA-938' is already in 'Backlog'. Skipping transition.
2025-06-20 19:11:49,751 - INFO - 
--- Phase 2: Rolling back Confluence Pages to Previous Versions ---
2025-06-20 19:11:49,752 - WARNING - NOTE: This operation reverts the page to a previous version. Any legitimate changes made to the page by other users *after* the automation script ran will also be undone by this rollback.
2025-06-20 19:11:49,752 - INFO -   Attempting to roll back Confluence page '435271126' to version 1...
2025-06-20 19:11:51,038 - ERROR -     -> ERROR: Unexpected error rolling back Confluence page '435271126'. Details: TypeError("Confluence.update_page() got an unexpected keyword argument 'version_message'")
2025-06-20 19:11:51,038 - INFO -   Attempting to roll back Confluence page '435271127' to version 1...
2025-06-20 19:11:51,654 - ERROR -     -> ERROR: Unexpected error rolling back Confluence page '435271127'. Details: TypeError("Confluence.update_page() got an unexpected keyword argument 'version_message'")
2025-06-20 19:11:51,654 - INFO -   Attempting to roll back Confluence page '435271128' to version 1...
2025-06-20 19:11:52,271 - ERROR -     -> ERROR: Unexpected error rolling back Confluence page '435271128'. Details: TypeError("Confluence.update_page() got an unexpected keyword argument 'version_message'")
2025-06-20 19:11:52,271 - INFO -   Attempting to roll back Confluence page '435271129' to version 1...
2025-06-20 19:11:52,887 - ERROR -     -> ERROR: Unexpected error rolling back Confluence page '435271129'. Details: TypeError("Confluence.update_page() got an unexpected keyword argument 'version_message'")
2025-06-20 19:11:52,895 - INFO -   Attempting to roll back Confluence page '435271130' to version 1...
2025-06-20 19:11:53,495 - ERROR -     -> ERROR: Unexpected error rolling back Confluence page '435271130'. Details: TypeError("Confluence.update_page() got an unexpected keyword argument 'version_message'")
2025-06-20 19:11:53,495 - INFO -   Attempting to roll back Confluence page '435271132' to version 1...
2025-06-20 19:11:54,105 - ERROR -     -> ERROR: Unexpected error rolling back Confluence page '435271132'. Details: TypeError("Confluence.update_page() got an unexpected keyword argument 'version_message'")
2025-06-20 19:11:54,105 - INFO - 
--- Undo Automation Script Finished ---
2025-06-20 19:11:54,105 - INFO - Review the log file and Confluence/Jira to confirm changes.
